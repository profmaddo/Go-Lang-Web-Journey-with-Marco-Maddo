# 游쥟릖 Use the official Go image to compile the application
# 游游 Usa a imagem oficial do Go para compilar a aplica칞칚o
FROM golang:1.21 AS builder

# 游쥟릖 Set the working directory inside the container
# 游游 Define o diret칩rio de trabalho dentro do container
WORKDIR /app

# 游쥟릖 Copy all project files into the container (source code, go.mod, etc.)
# 游游 Copia todos os arquivos do projeto para dentro do container (c칩digo fonte, go.mod, etc.)
COPY . .

# 游쥟릖 Compile the Go app for Linux with no CGO dependencies (static binary)
# 游游 Compila a aplica칞칚o Go para Linux sem depend칡ncias CGO (bin치rio est치tico)
RUN CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -o webserver

# 游쥟릖 Start a new minimal runtime container using Alpine Linux
# 游游 Inicia um novo container m칤nimo usando Alpine Linux
FROM alpine:latest

# 游쥟릖 Set the working directory for the final container
# 游游 Define o diret칩rio de trabalho para o container final
WORKDIR /root/

# 游쥟릖 Copy the compiled binary from the builder stage
# 游游 Copia o bin치rio compilado da etapa de build
COPY --from=builder /app/webserver .

# 游쥟릖 Copy the HTML file to be served by the application
# 游游 Copia o arquivo HTML para ser servido pela aplica칞칚o
COPY --from=builder /app/index.html .

# 游쥟릖 Inform Docker that the container listens on port 8080
# 游游 Informa ao Docker que o container escuta na porta 8080
EXPOSE 8080

# 游쥟릖 Set the default command to run the Go web server
# 游游 Define o comando padr칚o para executar o servidor web em Go
CMD ["./webserver"]
